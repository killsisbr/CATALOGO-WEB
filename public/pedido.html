<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>BrutusWeb - Pedido via WhatsApp</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="mobile-container">
    <!-- Barra de informações de horário -->
    <div class="hours-bar">Funcionamento: 18:00 às 23:00</div>
    <!-- Cabeçalho -->
    <header class="app-header">
      <h1>Brutus Burger</h1>
      <div class="header-search">
        <input type="text" id="search-input" placeholder="Buscar lanche...">
        <button id="search-button" class="search-button">
          <i class="fas fa-search"></i>
        </button>
        <div id="search-results" class="search-results"></div>
      </div>
      <div class="header-actions">
        <button id="cart-icon" class="icon-button">
          <i class="fas fa-shopping-cart"></i>
          <span id="cart-count" class="cart-badge">0</span>
        </button>
      </div>
    </header>

    <!-- Seletor de Categorias (dinâmico - populado via /api/categorias) -->
    <div class="category-selector">
      <div id="category-buttons-container" class="category-buttons-container">
        <!-- Botões de categoria serão inseridos aqui via JS -->
      </div>
    </div>

    <!-- Carrossel de Produtos -->
    <section class="product-carousel">
      <div class="carousel-container">
        <button id="prev-product" class="carousel-btn prev">
          <i class="fas fa-chevron-left"></i>
        </button>
        <div id="current-product" class="current-product">
          <!-- Produto atual será inserido via JS -->
        </div>
        <button id="next-product" class="carousel-btn next">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
      <div class="carousel-indicators">
        <div id="carousel-dots" class="dots-container">
          <!-- Indicadores serão inseridos via JS -->
        </div>
      </div>
    </section>

    <!-- Modal de Quantidade -->
    <div id="quantity-modal" class="modal">
      <div class="modal-content quantity-modal">
        <div class="modal-header">
          <h2>Selecionar Quantidade</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <div class="product-preview">
            <img id="quantity-product-image" src="" alt="" class="preview-image">
            <div class="product-details">
              <h3 id="quantity-product-name"></h3>
              <div class="product-price" id="quantity-product-price"></div>
            </div>
          </div>
          <div class="quantity-selector">
            <div class="quantity-control">
              <button id="decrease-quantity" class="quantity-btn">-</button>
              <span id="selected-quantity" class="quantity-display">1</span>
              <button id="increase-quantity" class="quantity-btn">+</button>
            </div>
          </div>
          <div class="observation-section">
            <label for="observation-input">Observações:</label>
            <textarea id="observation-input" placeholder="Ex: Sem cebola, ponto da carne, etc."></textarea>
          </div>
          <button id="add-to-cart-confirm" class="add-to-cart">Adicionar ao Carrinho</button>

          <!-- Seção de Adicionais -->
          <div id="additionals-section" class="additionals-section">
            <h3>Adicionais</h3>
            <div id="additionals-list" class="additionals-list">
              <!-- Adicionais serão carregados aqui -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Carrinho -->
    <div id="cart-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Carrinho (<span id="cart-count-modal">0</span>)</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <ul id="cart-items" class="cart-items">
            <!-- Itens do carrinho serão inseridos via JS -->
          </ul>
          <div class="cart-summary">
            <div class="total">
              <span>Total:</span>
              <span id="cart-total">R$ 0,00</span>
            </div>
            <button id="checkout-btn" class="checkout-button">Finalizar Pedido</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Finalização -->
    <div id="checkout-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Finalizar Pedido</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <div id="whatsapp-info" class="whatsapp-info">
            <i class="fab fa-whatsapp whatsapp-icon"></i>
            <p>Pedido iniciado via WhatsApp</p>
          </div>
          
          <div class="order-summary">
            <h3>Resumo do Pedido</h3>
            <ul id="order-items-summary">
              <!-- Itens do pedido serão inseridos via JS -->
            </ul>
            <div class="total">
              <span>Total:</span>
              <span id="order-total">R$ 0,00</span>
            </div>
            
            <!-- Formulário de cliente -->
            <div class="client-form">
              <h3>Seus Dados</h3>
              <div class="form-group">
                <label for="client-name">Nome: *</label>
                <input type="text" id="client-name" placeholder="Seu nome completo">
              </div>
              <!-- REMOVIDO: Campo de telefone opcional -->
              <div class="form-group">
                <label for="client-address-preview">Endereço: *</label>
                <div id="client-address-preview" class="client-address-preview">Nenhum endereço selecionado</div>
                <input type="hidden" id="client-address" name="client-address" value="">
                  <button type="button" id="calcular-taxa-btn" class="calcular-taxa-btn" style="margin-top: 10px; display:none;" disabled aria-disabled="true">
                    <i class="fas fa-calculator"></i> Calcular Taxa de Entrega
                  </button>
                <!-- previous-address removed per request -->
              </div>
              
              <!-- Seção de Entrega -->
              <div id="delivery-section" class="delivery-section">
                <h3>Entrega</h3>
                  <button type="button" id="use-location-btn" class="use-location-btn">
                    <i class="fas fa-map-marker-alt"></i> Calcular frete
                  </button>
                
                <!-- Informações da entrega -->
                <div id="delivery-info" class="delivery-info" style="display: none;">
                  <p>Distância: <span id="delivery-distance">0</span> km</p>
                  <p>Valor da entrega: R$ <span id="delivery-price">0,00</span></p>
                  <div id="delivery-note" style="display:none; margin-top:8px;">
                    <strong>Observações do local:</strong> <span id="delivery-note-main"></span>
                  </div>
                </div>
                
                <!-- Erros da entrega -->
                <div id="delivery-error" class="delivery-error" style="display: none; color: #e74c3c;">
                </div>
                
                <!-- Campo oculto para coordenadas -->
                <input type="hidden" id="client-coordinates" name="client-coordinates">
              </div>
              
              <!-- Opção de Retirada no Balcão (FORA do delivery-section para não ser escondido) -->
              <div id="pickup-section" class="pickup-section">
                <div class="pickup-toggle">
                  <label class="toggle-switch">
                    <input type="checkbox" id="pickup-checkbox">
                    <span class="toggle-slider"></span>
                  </label>
                  <span class="pickup-label">
                    <i class="fas fa-store"></i> Retirar no Balcão
                  </span>
                </div>
                <p class="pickup-info" id="pickup-info-text" style="display: none;">
                  <i class="fas fa-info-circle"></i> Você optou por retirar no balcão. Sem taxa de entrega!
                </p>
              </div>
              
              <!-- Modal do Mapa -->
              <div id="map-modal" class="modal">
                <div class="modal-content map-modal-content">
                  <div class="modal-header">
                    <h2>Selecionar Localização</h2>
                    <button class="close-button">&times;</button>
                  </div>
                  <div class="modal-body">
                    <div id="map-container" style="width: 100%; height: 400px; margin-bottom: 20px;"></div>
                    <div class="map-controls">
                      <button id="confirm-location-btn" class="confirm-button">Confirmar Localização</button>
                      <button id="cancel-map-btn" class="checkout-button">Cancelar</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Modal de Confirmação de Endereço -->
              <div id="address-confirm-modal" class="modal">
                <div class="modal-content">
                  <div class="modal-header">
                    <h2>Confirme seu Endereço</h2>
                    <button class="close-address-modal">&times;</button>
                  </div>
                  <div class="modal-body">
                    <p class="modal-description">Verifique se o endereço está correto e edite se necessário:</p>
                    <div class="form-group">
                      <label for="address-confirm-input">Endereço:</label>
                      <textarea id="address-confirm-input" rows="4"></textarea>
                    </div>
                    <div class="delivery-info-preview">
                      <p><strong>Distância:</strong> <span id="modal-distance">0</span> km</p>
                      <p><strong>Valor da entrega:</strong> R$ <span id="modal-delivery-price">0,00</span></p>
                    </div>
                    <div id="delivery-note-preview" style="display:none; margin-top:10px;" class="delivery-info-preview">
                      <p><strong>Observações do local:</strong> <span id="delivery-note-text"></span></p>
                    </div>
                    <div class="form-group">
                      <label for="address-notes">Observações do local (cor da casa, ponto de referência, vizinho da frente):</label>
                      <textarea id="address-notes" rows="2" placeholder="Ex: Casa azul com portão verde, número 15 - vizinho da frente é o nº 17"></textarea>
                    </div>
                    <div class="map-controls">
                      <button id="confirm-address-btn" class="confirm-button">Confirmar Endereço</button>
                      <button id="cancel-address-btn" class="checkout-button">Cancelar</button>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="payment-method">Forma de Pagamento:</label>
                  <select id="payment-method" class="form-control">
                    <option value="dinheiro">Dinheiro</option>
                    <option value="cartao">Cartão</option>
                    <option value="pix">PIX</option>
                  </select>
                </div>
              </div>
              
              <!-- Campo para valor pago em dinheiro -->
              <div id="dinheiro-section" style="display: none;">
                <label for="valor-pago">Valor da nota (R$):</label>
                <input type="number" id="valor-pago" step="0.01" min="0" placeholder="0,00">
                <small>Informe o valor da nota para calcular o troco</small>
              </div>
            </div>
            
            <button id="confirm-order" class="confirm-button">Confirmar Pedido</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmação -->
    <div id="confirmation-modal" class="modal">
      <div class="modal-content confirmation">
        <div class="modal-body">
          <i class="fas fa-check-circle confirmation-icon"></i>
          <h2>Pedido Confirmado!</h2>
          <p>Obrigado pelo seu pedido.</p>
          <button id="new-order-btn" class="new-order-button">Novo Pedido</button>
        </div>
      </div>
    </div>
  </div>
  <script src="apply-custom-settings.js"></script>
  <script src="mapa.js"></script>
  <script src="pedido-script-debug.js"></script>
  <script src="image-debug.js"></script>
</body>
</html>
